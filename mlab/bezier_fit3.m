x = [-3018, -3036, -3053, -3068, -3082, -3095, -3106, -3115, -3123, -3129, -3134, -3137, -3139, -3139, -3139, -3138, -3136, -3133, -3129, -3124, -3119, -3113, -3106, -3099, -3091, -3083, -3074, -3065, -3055, -3045, -3034, -3023, -3011, -2998, -2985, -2972, -2958, -2944, -2929, -2914, -2899, -2883, -2867, -2852, -2837, -2822, -2808, -2794, -2781, -2768];
y = [-399, -381, -362, -342, -321, -299, -277, -255, -232, -209, -187, -165, -144, -124, -105, -87, -70, -54, -39, -25, -12, 0, 12, 23, 33, 43, 52, 60, 68, 75, 81, 87, 92, 96, 100, 103, 105, 106, 106, 106, 105, 103, 100, 96, 91, 85, 78, 70, 61, 52];
x = x / 4096;
y = y / 4096;
x0 = x(1:22);
y0 = y(1:22);
x1 = x(22:end);
y1 = y(22:end);

hold off
scatter(x0, y0, 5);
hold on
scatter(x1, y1, 5);

t = linspace(0, 1, length(x0));
T = [ones(1, length(t)); t; t.^2; t.^3]';

cx = (T'*T)^-1 * T' * x0';
cy = (T'*T)^-1 * T' * y0';

fitx = cx(1) + cx(2)*t + cx(3)*t.^2 + cx(4)*t.^3;
fity = cy(1) + cy(2)*t + cy(3)*t.^2 + cy(4)*t.^3;
plot(fitx, fity);

t = linspace(0, 1, length(x1));
T = [ones(1, length(t)); t; t.^2; t.^3]';

cx = (T'*T)^-1 * T' * x1';
cy = (T'*T)^-1 * T' * y1';

fitx = cx(1) + cx(2)*t + cx(3)*t.^2 + cx(4)*t.^3;
fity = cy(1) + cy(2)*t + cy(3)*t.^2 + cy(4)*t.^3;
plot(fitx, fity);

